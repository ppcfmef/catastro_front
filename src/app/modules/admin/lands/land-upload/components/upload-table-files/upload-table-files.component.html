<ng-container *ngIf="posicionExcel">
    <div class="flex flex-col gap-3">
        <div class="text-2xl font-extrabold tracking-tight leading-none">{{ title }}</div>
        <div class="flex flex-col">
            <table [ngClass]="styleTable" mat-table [dataSource]="dataSource" class="shadow bg-card w-full">

                
                <ng-container matColumnDef="index">
                    <th mat-header-cell *matHeaderCellDef> No.</th>
                    <td mat-cell *matCellDef="let element; let i = index;"> {{ params['offset'] + i +1 }} </td>
                </ng-container>

                <ng-container matColumnDef="status">
                    <th mat-header-cell *matHeaderCellDef> Estado</th>
                    <td mat-cell *matCellDef="let element">
                        <ng-container [ngSwitch]="element.status">
                            <ng-container *ngSwitchCase="'ERROR'">ERROR</ng-container>
                            <ng-container *ngSwitchCase="'OK_NEW'">INSERTAR</ng-container>
                            <ng-container *ngSwitchCase="'OK_OLD'">ACTUALIZAR</ng-container>
                            <ng-container *ngSwitchDefault></ng-container>
                        </ng-container>
                        </td>
                </ng-container>

                <ng-container matColumnDef="errorCode">
                    <th mat-header-cell *matHeaderCellDef> Error</th>
                    <td mat-cell *matCellDef="let element">
                        <ng-container [ngSwitch]="element.errorCode">
                            <ng-container *ngSwitchCase="'IS_REQUIRED[ubigeo]'">UBIGEO es requerido</ng-container>
                            <ng-container *ngSwitchCase="'IS_REQUIRED[cod_pre]'">COD_PRE es requerido</ng-container>
                            <ng-container *ngSwitchCase="'CODE_ERROR[cod_pre]'">COD_PRE incorrecto</ng-container>
                            <ng-container *ngSwitchCase="'CODE_ERROR[cod_contr]'">COD_CONTR incorrecto</ng-container>
                            <ng-container *ngSwitchCase="'IS_REQUIRED[cod_contr]'">COD_CONTR es requerido</ng-container>
                            <ng-container *ngSwitchCase="'NOT_INSERT[exists_owner_with_document]'">Ya existe Controbuyente con este DNI</ng-container>
                            <ng-container *ngSwitchCase="'DUPLICATE'">REGISTRO DUPLICADO</ng-container>
                            <ng-container *ngSwitchCase="'DUPLICATE[owner]'">CONTRIBUYENTE DUPLICADO </ng-container>
                            <ng-container *ngSwitchDefault>VALIDO</ng-container>
                        </ng-container>
                    </td>
                </ng-container>
                
                <ng-container matColumnDef="line">
                    <th mat-header-cell *matHeaderCellDef> Fila </th>                
                    <ng-container >
                        <td mat-cell *matCellDef="let element">{{ element.orderRecord }}</td>
                    </ng-container>                
                </ng-container>

                <ng-container matColumnDef="data">
                    <th mat-header-cell *matHeaderCellDef> Datos </th>                
                    <ng-container >
                        <td mat-cell *matCellDef="let element">
                            UBIGEO:{{ element.record.ubigeo }}<br />
                            COD_PRE: {{ element.record.codPre }}<br />
                            COD_CONTR: {{ element.record.codContr }}<br />
                            {{ element.record.nombre + ' ' + element.record.apPat }}
                        </td>
                    </ng-container>                
                </ng-container>
    
    
                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>
            <mat-paginator #paginator [pageSize]="5" [pageSizeOptions]="[5, 10, 25, 50, 100, 250, 500]" (page)="page($event)">
            </mat-paginator>
        </div>
        <div class="flex flex-row-reverse" *ngIf="isDownload && dataSource">
            <button class="justify-end mat-focus-indicator mat-flat-button mat-button-base mat-primary"
            (click)="eventDownload.emit()">
                <mat-icon svgIcon="heroicons_outline:document-download"></mat-icon>
                <span class="ml-2 mr-1">Descargar</span>
            </button>
        </div>
    </div>
</ng-container>

<ng-container *ngIf="!posicionExcel">
    <div class="flex flex-col gap-3">
        <div class="text-2xl font-extrabold tracking-tight leading-none">{{ title }}</div>
        <div class="flex flex-col">
            <table [ngClass]="styleTable" mat-table [dataSource]="dataSource" class="shadow bg-card w-full">

                
                <ng-container matColumnDef="index">
                    <th mat-header-cell *matHeaderCellDef> No.</th>
                    <td mat-cell *matCellDef="let element; let i = index;"> {{ params['offset'] + i +1 }} </td>
                </ng-container>
    
    
                <ng-container matColumnDef="depCensal">
                    <th mat-header-cell *matHeaderCellDef> Dep. Censal </th>                
                    <ng-container>
                        <td mat-cell *matCellDef="let element"> {{element.sede.departamento.sede}} </td>
                    </ng-container>              
                </ng-container>
                
                <ng-container matColumnDef="provCensal">
                    <th mat-header-cell *matHeaderCellDef> Prov. Censal </th>                
                    <ng-container>
                        <td mat-cell *matCellDef="let element"> {{element.sede.sede}} </td>
                    </ng-container>              
                </ng-container>

                <ng-container matColumnDef="distCensal">
                    <th mat-header-cell *matHeaderCellDef> Dist. Censal </th>                
                    <ng-container>
                        <td mat-cell *matCellDef="let element"> {{element.distritoCensal}} </td>
                    </ng-container>              
                </ng-container>

                <ng-container matColumnDef="jb">
                    <th mat-header-cell *matHeaderCellDef> Nro. JB </th>                
                    <ng-container>
                        <td mat-cell *matCellDef="let element"> {{element.brigada}} </td>
                    </ng-container>              
                </ng-container>

                <ng-container matColumnDef="empadronador">
                    <th mat-header-cell *matHeaderCellDef> Nro. Emp </th>                
                    <ng-container>
                        <td mat-cell *matCellDef="let element"> {{element.empadronador}} </td>
                    </ng-container>              
                </ng-container>

                <ng-container matColumnDef="periodo">
                    <th mat-header-cell *matHeaderCellDef> Periodo </th>                
                    <ng-container>
                        <td mat-cell *matCellDef="let element"> {{element.periodo}} </td>
                    </ng-container>              
                </ng-container>


                <ng-container matColumnDef="nivel">
                    <th mat-header-cell *matHeaderCellDef> Nivel </th>                
                    <ng-container>
                        <td mat-cell *matCellDef="let element"> {{element.nivel}} </td>
                    </ng-container>              
                </ng-container>

                <ng-container matColumnDef="codigo">
                    <th mat-header-cell *matHeaderCellDef>CÃ³digo </th>                
                    <ng-container>
                        <td mat-cell *matCellDef="let element"> {{element.codigo}} </td>
                    </ng-container>              
                </ng-container>

                <ng-container matColumnDef="ruta">
                    <th mat-header-cell *matHeaderCellDef> Ruta </th>                
                    <ng-container>
                        <td mat-cell *matCellDef="let element"> {{element.ruta}} </td>
                    </ng-container>              
                </ng-container>
    
                <ng-container *ngIf="!posicionExcel" matColumnDef="estadoUdra">
                    <th mat-header-cell *matHeaderCellDef> Estado UDRA</th>
                    <td mat-cell *matCellDef="let element"> {{element.estadoUdra?'Recepcionado':'Pendiente'}} </td>
                </ng-container>
    
    
                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>
            <mat-paginator #paginator [pageSize]="params.limit" [pageSizeOptions]="[5, 10, 25, 50, 100, 250, 500]" (page)="page($event)">
            </mat-paginator>
        </div>
        <div class="flex flex-row-reverse" *ngIf="isDownload">
            <button class="justify-end mat-focus-indicator mat-flat-button mat-button-base mat-primary" (click)="eventDownload.emit()">
                <mat-icon svgIcon="heroicons_outline:document-download"></mat-icon>
                <span class="ml-2 mr-1">Descargar</span>
            </button>
        </div>
    </div>
</ng-container>



