<!-- Button -->
<button
    mat-button
    [matMenuTriggerFor]="userActions">
    <span class="relative flex items-center gap-2">
        <div class="flex flex-col items-end">
            <span class="whitespace-nowrap overflow-ellipsis overflow-hidden text-sm leading-tight">
                {{user?.name || '-'| titlecase}}
            </span>
            <span class="whitespace-nowrap overflow-ellipsis overflow-hidden font-bold text-xs">
                {{user?.municipalName || '-'}}
            </span>
        </div>

        <img
            class="w-7 h-7 rounded-full"
            *ngIf="showAvatar && user.avatar"
            [src]="user.avatar">
        <mat-icon
            *ngIf="!showAvatar || !user.avatar"
            [svgIcon]="'heroicons_outline:user-circle'"></mat-icon>
        <span
            class="bg-green-500 absolute right-0 bottom-0 w-2 h-2 rounded-full mr-px mb-1"
        ></span>
    </span>
</button>

<mat-menu
    [xPosition]="'before'"
    #userActions="matMenu">
    <button mat-menu-item>
        <span class="flex flex-col leading-none">
            <span class="text-base font-semibold">{{user?.name || '-'}}</span>
            <span class="mt-1.5 text-md font-medium text-mef-gray-200">{{user?.email || '-'}}</span>
        </span>
    </button>
    <mat-divider class="my-2"></mat-divider>
    <button mat-menu-item [routerLink]="'./account/profile'">
        <mat-icon [svgIcon]="'heroicons_outline:user-circle'"></mat-icon>
        <span>Perfil</span>
    </button>
    <button mat-menu-item *ngIf="false">
        <mat-icon [svgIcon]="'heroicons_outline:cog'"></mat-icon>
        <span>Configuracion</span>
    </button>
    <!-- <button
        mat-menu-item
        [matMenuTriggerFor]="userStatus">
        <mat-icon [svgIcon]="'heroicons_outline:dots-circle-horizontal'" *ngIf="false"></mat-icon>
        <span>Estado</span>
    </button> -->
    <mat-divider class="my-2"></mat-divider>
    <button
        mat-menu-item
        (click)="signOut()">
        <mat-icon [svgIcon]="'heroicons_outline:logout'"></mat-icon>
        <span>Cerrar Sesion</span>
    </button>
</mat-menu>

<mat-menu
    class="user-status-menu"
    #userStatus="matMenu">
    <button
        mat-menu-item
        (click)="updateUserStatus(true)">
        <span class="w-4 h-4 mr-3 rounded-full bg-green-500"></span>
        <span>Online</span>
    </button>
    <button
        mat-menu-item
        (click)="updateUserStatus(false)">
        <span class="w-4 h-4 mr-3 rounded-full bg-red-500"></span>
        <span>Offline</span>
    </button>
</mat-menu>
